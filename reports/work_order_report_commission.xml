<?xml version="1.0" encoding="UTF-8"?>
<odoo>
<record id="transp_driver_paperformat" model="report.paperformat">
	   <field name="name">Tranp driver</field>
	   <field name="default" eval="True"/>
	   <field name="format">custom</field>
	   <field name="page_height">297</field>
	   <field name="page_width">210</field>
	   <field name="orientation">Landscape</field>
      <field name="margin_top">30</field>
    <field name="margin_bottom">20</field>
    <field name="margin_left">5</field>
    <field name="margin_right">5</field>
	   <field name="header_line" eval="True"/>
	   <field name="header_spacing">20</field>
	  <field name="dpi">90</field>
	</record>


	<report id="transp_driver_report"
				model="tranp.driver.report"
				string="حركه السائقين"
				report_type="qweb-pdf"
				name="qimamhd_transportation_v2_rads.transp_driver_report_view"
				file="qimamhd_transportation_v2_rads.transp_driver_report_view"
        paperformat="qimamhd_transportation_v2_rads.transp_driver_paperformat"

				 menu="True"

				/>
    <report
        id="transp_driver_report_xlsx"
        model="tranp.driver.report"
        string="Print to XLSX"
        report_type="xlsx"
        name="qimamhd_transportation_v2_rads.mntns_commission_report_xlsx_view"
        file="حركه السائقين"
        attachment_use="False"
        />

   

		<template id="transp_driver_report_view">
		  

			<t t-call ="web.html_container">

			 <t t-set="data_report_margin_top" t-value="30"/>
            <t t-set="data_report_header_spacing" t-value="25"/>
            <t t-set="data_report_dpi" t-value="120"/>
            <t t-call="web.external_layout">
            
             <style>
                        
                        table {
                          width:100%;
                          font-size: 14px;
                        }
                       #t05 table, th, td {
                          border: 0px solid black;
                          border-collapse: collapse;
                          padding: 5px;
                          <!--background-color:white;-->
                          
                        }
                        th, td {
                          padding: 5px;
                          font-size: 14px;
                        }
                        #rcorners1{
                              border-radius: 5px;
                              border: 0px solid gray;
                              padding: 5px; 
                              width: 200px;
                              text-align:center;
                               margin: auto; 
                            }
                         #rcorners2{
                          border-radius: 5px;
                          border: 1px solid gray;
                          padding: 5px; 
                           margin: auto; 
                        }
                        #t01 th {
                            background-color: LightGray;
                            
                        }
             #rcorners3{
              border-radius: 5px;
              border: 1px solid gray;
              padding: 5px; 
            }
            div { margin: auto; }
        </style>
        

						<div class="page">
              <br /> <br />
                  
								       <center><strong> تقرير حركه السائقين </strong></center>
 
                        <center>  
                            <br />
                            <strong> من تاريخ:</strong> <t t-esc="date_start"/>
                            <strong> الى تاريخ:</strong> <t t-esc="date_end"/>
                        </center>
                          <br />
                       
                                <t t-if="report_type == 'detail'">
                                   
                                    <t t-set="l_commisiion_total_all" t-value="0"/>
                                    <t t-foreach="company_car_driver" t-as="rec">
                                      <br></br>

                                      <div style="background-color:lightgray;color:black;">
                                          <strong> السائق: <span t-esc="rec.name"/></strong>
                                      </div>
                                            <table  id="customers">
                                              <thead>
                                                <tr class="text-center">
                                                    <th class="text-center" style="width: 3%">#</th>
                                                    <th class="text-center" style="width: 6%">رقم الشحنة</th>
                                                    <th class="text-center" style="width: 7%">تاريخ الطلب</th>
                                                    <th class="text-center" style="width: 10%">العميل</th>
                                                    <th class="text-center" style="width: 5%">سعر البيع</th>
                                                    <th class="text-center" style="width: 6%">سعر الوقفة</th>
                                                    <th class="text-center" style="width: 6%">ايام الوقفة</th>
                                                    <th class="text-center" style="width: 6%">مسار الشحن</th>
                                                    <th class="text-center" style="width: 6%">مسار التفريغ</th>
                                                    <th class="text-center" style="width: 7%">عمولة السائق</th>
                                                    <th class="text-center" style="width: 6%">نوع العمولة</th>
                                                    <th class="text-center" style="width: 6%">تاريخ الحمولة</th>
                                                    <th class="text-center" style="width: 6%">رقم البوليصة</th>
                                                    <!-- <th class="text-center" style="width: 10%">المورد</th> -->
                                                    <th class="text-center" style="width: 5%">السيارة</th>
                                                    <th class="text-center" style="width: 6%">هوية السائق</th>
                                                    <th class="text-center" style="width: 6%">جوال السائق</th>
                                                     <th class="text-center" style="width: 7%">رقم الفاتورة</th>
                                                    <th class="text-center" style="width: 5%">مركز التكلفة</th>

                                                    
                                                  
                                                </tr>
                                              </thead>
                                              <tbody>
                                              <t t-set="l_cnt" t-value="0"/>
                                               <t t-set="l_commission_total" t-value="0"/>
                                                <t t-foreach="docs_compelete.filtered(lambda x: x.company_driver_id.id == rec.id)" t-as="line">                                       
                                                  <tr>
                                                      <t t-set="l_cnt" t-value="l_cnt + 1"/>
                                                        <t t-set="comm_amount" t-value="0"/>

                                                      
                                                         <t t-set="comm_amount" t-value="line.driver_btrip_amount"/>

                                                         <t t-set="l_commission_total" t-value="comm_amount + l_commission_total"/>
                                                          
                                                         <t t-set="l_commisiion_total_all" t-value="comm_amount + l_commisiion_total_all"/>
                                                   
                                                      

                                                      
                                                    <td>
                                                        <span t-esc="l_cnt"/>
                                                    </td>
                                                        <td>
                                                        <span t-esc="line.seq"/>
                                                    </td>
                                                    
                                                      <td>
                                                        <span t-esc="line.order_date"/>
                                                    </td>
                                                  
                                                    <td>
                                                          <span style="color:gray;" /> <span t-esc="line.partner_branch_id.name"/> 
                                                    </td> 

                                                      <td>
                                                          <span style="color:gray;" /> <span t-esc="line.customer_price"/> 
                                                    </td>     
                                                      <td>
                                                          <span style="color:gray;" /> <span t-esc="line.customer_stop"/> 
                                                    </td>     
                                                      <td>
                                                          <span style="color:gray;" /> <span t-esc="line.stopped_days"/> 
                                                    </td>     

                                                    <td>
                                                      <span style="color:gray;" />  <span t-esc="line.transp_path_from.name"  />
                                                    </td>
                                                    <td>
                                                       <span style="color:gray;" />  <span t-esc="line.transp_path_to.name"  />
                                                    </td>
                                                      <td>
                                                        <span t-esc="comm_amount"/>
                                                    </td>
                                                    
                                                    <td>
                                                      <span style="color:gray;" /> <span t-esc="line.driver_btrip_selection"/>
                                                    </td>
                                                     <td>
                                                        <span style="color:gray;" /> <span t-esc="line.load_date"/>
                                                    </td>
                                                      <td>
                                                        <span style="color:gray;" /> <span t-esc="line.invoice_manual"/>
                                                    </td>
                                                      <!-- <td>
                                                        <span style="color:gray;" /> <span t-esc="line.supplier_id.name"/>
                                                    </td> -->
                                                    <td>
                                                        <span style="color:gray;" /> <span t-esc="line.product_car_id.name"/>
                                                    </td>
                                                    <td>
                                                      <span style="color:gray;" />  <span t-esc="line.driver_identity"  />
                                                    </td>
                                                     <td>
                                                      <span style="color:gray;" />  <span t-esc="line.mobile_no"  />
                                                    </td>
                                                 
                                                    <td>
                                                          <span style="color:gray;" /> <span t-esc="line.sale_invoice_id.name"/> 
                                                    </td>
                                                    
                                                      <td>
                                                      <span style="color:gray;" />  <span t-esc="line.analytic_account_id.name"  />
                                                    </td>
                                                  
                                                    
                                                  </tr>
                                                    
                                              </t>
                                              </tbody>

                                              <tr style="background-color:gray;color:white;"  class="text-center">
                                                  <td  colspan="9">
                                                      <strong> 
                                                      الاجمالي  
                                                    </strong>
                                                </td>
 
                                                <td>
                                                    <strong>
          
                                                      <span t-esc=" '{:,.2f}'.format(l_commission_total )" /></strong>


                                                </td>
                                                
                                              </tr>
                                          </table>
                                        </t>  
                                      <table  id="customers">
                                      <tr style="background-color:gray;color:white;"  class="text-center">
                                          <td  colspan="13">
                                              <strong> اجمالي عمولات السائقين</strong>

                                          </td>
 
                                            <td style="color:white;">
                                              <strong>
    
                                                <span t-esc="'{:,.2f}'.format(l_commisiion_total_all)" /></strong>


                                          </td>

                                        </tr>


                                    </table>
                                </t>
                                <t t-if="report_type == 'summary'">
                                   <t t-set="l_amount_total_all" t-value="0"/>
                                    <t t-set="l_amount_tax_all" t-value="0"/>
                                    <t t-set="l_amount_untaxed_all" t-value="0"/>
                                    <t t-set="l_commission_amount_all" t-value="0"/>
                                    <table  id="customers">
                                        <thead>
                                          <tr class="text-center">
                                              <th class="text-center" style="width: 5%">#</th>
                                              <th class="text-center" style="width: 40%">المندوب</th>
                                              <th class="text-center" style="width: 15%">المبيعات قبل الضريبة</th>
                                              <th class="text-center" style="width: 15%">اجمالي الضريبة</th>
                                              <th class="text-center" style="width: 15%">المبيعات شامل الضريبة</th>
                                              <th class="text-center" style="width: 10%">اجمالي العمولة</th>
                                          </tr>
                                        </thead>
                                        <tbody>
                                        <t t-set="l_cnt" t-value="0"/>
                                            <t t-foreach="sale_mans" t-as="rec">
                                                <tr>
                                                   

                                                      <t t-set="l_amount_total" t-value="sum(l.amount_total if l.type == 'out_invoice' else l.amount_total * -1 for l in docs_compelete.filtered(lambda x: x.checkup_order_id.sale_man_id.id == rec.id))"/>
                                                      <t t-set="l_amount_tax" t-value="sum(l.amount_tax if l.type == 'out_invoice' else l.amount_tax *-1 for l in docs_compelete.filtered(lambda x: x.checkup_order_id.sale_man_id.id == rec.id))"/>
                                                      <t t-set="l_amount_untaxed" t-value="sum(l.amount_untaxed if l.type == 'out_invoice' else l.amount_untaxed * -1 for l in docs_compelete.filtered(lambda x: x.checkup_order_id.sale_man_id.id == rec.id))"/>
                                                      <t t-set="l_commission_amount" t-value="sum(l.checkup_order_id.commission_amount if l.type == 'out_invoice' else l.checkup_order_id.commission_amount * -1 for l in docs_compelete.filtered(lambda x: x.checkup_order_id.sale_man_id.id == rec.id))"/>
                                           
                                                      <t t-set="l_cnt" t-value="l_cnt + 1"/>
                                                   
                                                      <t t-set="l_amount_total_all" t-value="l_amount_total + l_amount_total_all"/>
                                                      <t t-set="l_amount_tax_all" t-value="l_amount_tax + l_amount_tax_all"/>
                                                      <t t-set="l_amount_untaxed_all" t-value="l_amount_untaxed + l_amount_untaxed_all"/>
                                                      <t t-set="l_commission_amount_all" t-value="l_commission_amount + l_commission_amount_all"/>


                                                    <td>
                                                        <span t-esc="l_cnt"/>
                                                    </td>

                                                    <td>
                                                        <span t-esc="rec.name"/>
                                                    </td>
                                                    <td>
                                                      <span style="color:gray;" />
                                                         <span t-esc="'{:,.2f}'.format(l_amount_untaxed)"/>
                                                      
                                                    </td>
                                                    <td>
                                                      <span style="color:gray;" />
                                                          <span t-esc="'{:,.2f}'.format(l_amount_tax)"/>
                                                        
                                                    </td>
                                                 
                                                    <td>
                                                       <span style="color:gray;" />
                                                          <span t-esc="'{:,.2f}'.format(l_amount_total)"/>
                                                      
                                                    </td>
                                                    <td>
                                                       <span style="color:gray;" />
                                                          <span t-esc="'{:,.2f}'.format(l_commission_amount)"/>
                                                      
                                                    </td>

                                                  </tr>
                                                    
                                              </t>
                                            </tbody>
                                            <tr style="background-color:gray;color:white;"  class="text-center">
                                            <td  colspan="2">
                                                <strong>   الاجمالي الكلي</strong>

                                            </td>

                                            <td style="color:white;">
                                                <strong>
      
                                                  <span t-esc="'{:,.2f}'.format(l_amount_untaxed_all)" /></strong>


                                            </td>
                                            <td style="color:white;">
                                                <strong>
                                                <span t-esc=" '{:,.2f}'.format(l_amount_tax_all)" /></strong>

                                            </td>
                                      
                                            <td style="color:white;">
                                                <strong>
                                                <span t-esc="'{:,.2f}'.format(l_amount_total_all)" /></strong>

                                            </td>
                                              
                                             <td style="color:white;">
                                                <strong>
                                                <span t-esc="'{:,.2f}'.format(l_commission_amount_all)" /></strong>

                                            </td>
                                              
                                          </tr>


                                    </table>

                                </t>
                                
                      
              </div>

              <p style="page-break-after:always;">
                      </p>
				</t>
				</t>
	</template>


</odoo>
